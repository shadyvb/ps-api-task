<?php

namespace App\Http\Controllers\Api;

use App\Http\Controllers\Controller;
use App\Http\Requests\VulnerabilityRequest;
use App\Http\Resources\VulnerabilityResource;
use App\Models\Vulnerability;
use Illuminate\Http\JsonResponse;
use Illuminate\Http\Resources\Json\AnonymousResourceCollection;

class VulnerabilityController extends Controller
{
    /**
     * Display a listing of vulnerabilities.
     */
    public function index(): AnonymousResourceCollection
    {
        $vulnerabilities = Vulnerability::all();
        return VulnerabilityResource::collection($vulnerabilities);
    }

    /**
     * Store a newly created vulnerability.
     */
    public function store(VulnerabilityRequest $request): VulnerabilityResource
    {
        $vulnerability = Vulnerability::create($request->validated());
        return new VulnerabilityResource($vulnerability);
    }

    /**
     * Display the specified vulnerability.
     */
    public function show(Vulnerability $vulnerability): VulnerabilityResource
    {
        return new VulnerabilityResource($vulnerability);
    }

    /**
     * Update the specified vulnerability.
     */
    public function update(VulnerabilityRequest $request, Vulnerability $vulnerability): VulnerabilityResource
    {
        $vulnerability->update($request->validated());
        return new VulnerabilityResource($vulnerability);
    }

    /**
     * Remove the specified vulnerability.
     */
    public function destroy(Vulnerability $vulnerability): JsonResponse
    {
        $vulnerability->delete();
        return response()->json(['message' => 'Vulnerability deleted successfully'], 200);
    }
}
